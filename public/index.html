<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Jimmy’s Pizza - Home</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="https://fonts.googleapis.com/css2?family=DynaPuff:wght@400;700&display=swap" rel="stylesheet" />
  <style>
    body {
      font-family: 'DynaPuff', cursive;
      margin: 0;
      padding: 0;
      background-color: #fff;
      color: #1D428A;
      text-align: center;
    }

    .homepage-content {
      padding: 60px 20px;
    }

    #age-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0, 0, 0, 0.9);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 9999;
    }

    .age-box {
      background: white;
      padding: 30px;
      border-radius: 10px;
      max-width: 400px;
      box-shadow: 0 0 10px rgba(0,0,0,0.3);
      text-align: center;
    }

    .age-box h2 {
      margin-bottom: 20px;
      color: #1D428A;
    }

    .age-box input {
      padding: 10px;
      font-size: 16px;
      width: 100%;
      margin-bottom: 10px;
      border: 1px solid #ccc;
      border-radius: 6px;
    }

    .age-box button {
      background-color: #F58426;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 6px;
      font-size: 16px;
      cursor: pointer;
      margin-top: 10px;
    }

    .age-box button:hover {
      background-color: #d46a1f;
    }

    .error-msg {
      color: red;
      font-size: 14px;
      margin-top: 5px;
    }

    header {
      background-color: #1D428A;
      color: white;
      padding: 20px;
    }
  </style>
</head>
<body>
  <!-- Age Modal -->
  <div id="age-modal">
    <div class="age-box">
      <h2>Enter Your Birthday</h2>
      <input type="text" id="birthday-input" placeholder="MM/DD/YYYY" />
      <div class="error-msg" id="age-error"></div>
      <button id="submit-birthday">Enter</button>
    </div>
  </div>

  <!-- Header Placeholder -->
  <div id="header-placeholder"></div>
  <script>
    fetch('/header.html')
      .then(res => res.text())
      .then(data => {
        document.getElementById('header-placeholder').innerHTML = data;
        const script = document.createElement('script');
        script.src = '/js/header.js';
        document.body.appendChild(script);
      });
  </script>

  <!-- Main Content -->
  <div class="homepage-content">
    <h1>Welcome to Jimmy’s Detroit-Style Pizza</h1>
    <p>Deep. Crispy. Cheesy. Delicious.</p>
    <a href="order.html">
      <button style="font-size: 18px; padding: 12px 24px;">Start Your Order</button>
    </a>
  </div>

  <!-- Footer -->
  <div id="footer-placeholder"></div>
  <script>
    fetch('/footer.html')
      .then(res => res.text())
      .then(data => {
        document.getElementById('footer-placeholder').innerHTML = data;
      });
  </script>

  <!-- Age Logic -->
  <script>
    function is21OrOlder(birthday) {
      const [month, day, year] = birthday.split('/').map(num => parseInt(num));
      if (!month || !day || !year || birthday.length !== 10) return false;

      const birthDate = new Date(year, month - 1, day);
      const today = new Date();
      const age = today.getFullYear() - birthDate.getFullYear();
      const m = today.getMonth() - birthDate.getMonth();
      const d = today.getDate() - birthDate.getDate();

      if (age > 21) return true;
      if (age === 21 && (m > 0 || (m === 0 && d >= 0))) return true;
      return false;
    }

    document.addEventListener("DOMContentLoaded", () => {
      if (localStorage.getItem("verifiedAge") === "true") {
        document.getElementById("age-modal").style.display = "none";
      }

      document.getElementById("submit-birthday").addEventListener("click", () => {
        const input = document.getElementById("birthday-input").value.trim();
        const error = document.getElementById("age-error");

        if (!/^\d{2}\/\d{2}\/\d{4}$/.test(input)) {
          error.textContent = "Please use MM/DD/YYYY format.";
          return;
        }

        if (!is21OrOlder(input)) {
          error.textContent = "Sorry, you must be at least 21 years old.";
          return;
        }

        localStorage.setItem("verifiedAge", "true");
        document.getElementById("age-modal").style.display = "none";
      });
    });
  </script>

  <!-- Firebase & Core -->
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
  <script src="/js/firebase-config.js"></script>
  <script src="/js/app.js"></script>
  <script src="/js/footer.js"></script>
</body>
</html>